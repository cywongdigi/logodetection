C:\Users\cywong\AppData\Local\Programs\Python\Python310\python.exe C:/Users/cywong/PycharmProjects/logodetection/logodetection_training.py
[INFO] Starting training process...
[INFO] Preprocessing images...
[INFO] Finished preprocessing images.
[INFO] Loading images and extracting LBP features...
[INFO] Finished loading images and extracting LBP features.
[INFO] Balancing classes...
[WARNING] Skipping batch 16 due to only one class present.
[INFO] Finished balancing classes.
[INFO] Extracting ResNet-50 features...
[INFO] Finished extracting ResNet-50 features.
[INFO] Combining features...
[INFO] Finished combining and scaling features.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1237        2.9882       0.1237        2.9518  0.0000  2.0141
      2      0.2374        2.9011       0.2374        2.8777  0.0000  1.9341
      3      0.3232        2.8093       0.3232        2.8049  0.0000  1.9321
      4      0.3813        2.7287       0.3813        2.7341  0.0000  1.9331
      5      0.4369        2.6498       0.4369        2.6665  0.0000  1.9331
      6      0.5126        2.5681       0.5126        2.6012  0.0000  1.9341
      7      0.5707        2.5057       0.5707        2.5397  0.0000  1.9311
      8      0.5732        2.4534       0.5732        2.5335  0.0000  1.9321
      9      0.5808        2.4488       0.5808        2.5275  0.0000  1.9331
     10      0.5884        2.4425       0.5884        2.5213  0.0000  1.9301
     11      0.5884        2.4287       0.5884        2.5154  0.0000  1.9331
     12      0.5884        2.4312       0.5884        2.5092  0.0000  1.9331
     13      0.5934        2.4180       0.5934        2.5030  0.0000  1.9391
     14      0.5985        2.4150       0.5985        2.4970  0.0000  1.9421
     15      0.5985        2.4111       0.5985        2.4963  0.0000  1.9331
     16      0.5985        2.4011       0.5985        2.4957  0.0000  1.9341
     17      0.5985        2.4056       0.5985        2.4951  0.0000  1.9341
     18      0.5985        2.3993       0.5985        2.4945  0.0000  1.9321
     19      0.5985        2.4077       0.5985        2.4939  0.0000  1.9341
     20      0.5985        2.4040       0.5985        2.4933  0.0000  1.9321
     21      0.5985        2.3927       0.5985        2.4927  0.0000  1.9331
     22      0.5985        2.3964       0.5985        2.4926  0.0000  1.9311
     23      0.5985        2.4007       0.5985        2.4926  0.0000  1.9331
     24      0.5985        2.3998       0.5985        2.4925  0.0000  1.9351
     25      0.5985        2.3983       0.5985        2.4924  0.0000  1.9311
     26      0.5985        2.4019       0.5985        2.4924  0.0000  1.9321
     27      0.5985        2.3994       0.5985        2.4923  0.0000  1.9341
     28      0.5985        2.4008       0.5985        2.4923  0.0000  1.9321
     29      0.5985        2.3971       0.5985        2.4922  0.0000  1.9341
     30      0.5985        2.4037       0.5985        2.4922  0.0000  1.9311
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1338        2.9956       0.1338        2.9313  0.0000  1.9351
      2      0.2955        2.9088       0.2955        2.8569  0.0000  1.9631
      3      0.3813        2.8132       0.3813        2.7846  0.0000  1.9521
      4      0.4369        2.7382       0.4369        2.7155  0.0000  1.9491
      5      0.4924        2.6534       0.4924        2.6480  0.0000  1.9461
      6      0.5177        2.5735       0.5177        2.5824  0.0000  1.9481
      7      0.5404        2.5012       0.5404        2.5200  0.0000  1.9481
      8      0.5429        2.4624       0.5429        2.5138  0.0000  1.9531
      9      0.5480        2.4567       0.5480        2.5078  0.0000  1.9441
     10      0.5505        2.4478       0.5505        2.5018  0.0000  1.9421
     11      0.5556        2.4415       0.5556        2.4956  0.0000  1.9341
     12      0.5606        2.4311       0.5606        2.4896  0.0000  1.9451
     13      0.5606        2.4262       0.5606        2.4835  0.0000  1.9311
     14      0.5606        2.4164       0.5606        2.4776  0.0000  1.9371
     15      0.5606        2.4180       0.5606        2.4770  0.0000  1.9351
     16      0.5606        2.4141       0.5606        2.4764  0.0000  1.9351
     17      0.5606        2.4142       0.5606        2.4758  0.0000  1.9351
     18      0.5606        2.4087       0.5606        2.4751  0.0000  1.9361
     19      0.5631        2.4137       0.5631        2.4745  0.0000  1.9351
     20      0.5631        2.4173       0.5631        2.4739  0.0000  1.9331
     21      0.5631        2.4115       0.5631        2.4733  0.0000  1.9361
     22      0.5631        2.4103       0.5631        2.4733  0.0000  1.9351
     23      0.5631        2.4007       0.5631        2.4732  0.0000  1.9361
     24      0.5631        2.4024       0.5631        2.4732  0.0000  1.9361
     25      0.5631        2.4121       0.5631        2.4731  0.0000  1.9361
     26      0.5631        2.4165       0.5631        2.4730  0.0000  1.9351
     27      0.5631        2.4156       0.5631        2.4730  0.0000  1.9361
     28      0.5631        2.4133       0.5631        2.4729  0.0000  1.9351
     29      0.5631        2.4078       0.5631        2.4729  0.0000  1.9361
     30      0.5631        2.4159       0.5631        2.4729  0.0000  1.9371
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1439        2.9893       0.1439        2.9474  0.0000  1.9311
      2      0.2525        2.8983       0.2525        2.8743  0.0000  1.9351
      3      0.3611        2.8156       0.3611        2.8031  0.0000  1.9321
      4      0.4217        2.7352       0.4217        2.7349  0.0000  1.9411
      5      0.4823        2.6593       0.4823        2.6674  0.0000  1.9331
      6      0.5253        2.5711       0.5253        2.6035  0.0000  1.9351
      7      0.5530        2.5049       0.5530        2.5412  0.0000  1.9341
      8      0.5556        2.4640       0.5556        2.5352  0.0000  1.9451
      9      0.5556        2.4573       0.5556        2.5291  0.0000  1.9421
     10      0.5556        2.4541       0.5556        2.5232  0.0000  1.9341
     11      0.5581        2.4472       0.5581        2.5172  0.0000  1.9371
     12      0.5631        2.4368       0.5631        2.5111  0.0000  1.9421
     13      0.5682        2.4317       0.5682        2.5051  0.0000  1.9331
     14      0.5758        2.4203       0.5758        2.4991  0.0000  1.9341
     15      0.5758        2.4267       0.5758        2.4985  0.0000  1.9351
     16      0.5758        2.4251       0.5758        2.4979  0.0000  1.9341
     17      0.5758        2.4163       0.5758        2.4973  0.0000  1.9311
     18      0.5758        2.4074       0.5758        2.4967  0.0000  1.9321
     19      0.5758        2.4125       0.5758        2.4961  0.0000  1.9351
     20      0.5758        2.4219       0.5758        2.4955  0.0000  1.9291
     21      0.5783        2.4156       0.5783        2.4949  0.0000  1.9311
     22      0.5783        2.4150       0.5783        2.4948  0.0000  1.9321
     23      0.5783        2.4064       0.5783        2.4948  0.0000  1.9301
     24      0.5783        2.4184       0.5783        2.4947  0.0000  1.9351
     25      0.5783        2.4161       0.5783        2.4946  0.0000  1.9341
     26      0.5783        2.4121       0.5783        2.4946  0.0000  1.9311
     27      0.5783        2.4143       0.5783        2.4945  0.0000  1.9341
     28      0.5783        2.4086       0.5783        2.4945  0.0000  1.9371
     29      0.5783        2.4154       0.5783        2.4945  0.0000  1.9321
     30      0.5783        2.4154       0.5783        2.4944  0.0000  1.9361
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1237        2.9978       0.1237        2.9574  0.0000  1.9321
      2      0.2652        2.9124       0.2652        2.8853  0.0000  1.9331
      3      0.3662        2.8334       0.3662        2.8149  0.0000  1.9381
      4      0.4394        2.7434       0.4394        2.7485  0.0000  1.9301
      5      0.4848        2.6659       0.4848        2.6825  0.0000  1.9311
      6      0.5303        2.5842       0.5303        2.6195  0.0000  1.9311
      7      0.5606        2.5075       0.5606        2.5581  0.0000  1.9301
      8      0.5631        2.4679       0.5631        2.5522  0.0000  1.9311
      9      0.5682        2.4617       0.5682        2.5461  0.0000  1.9331
     10      0.5682        2.4486       0.5682        2.5401  0.0000  1.9311
     11      0.5682        2.4498       0.5682        2.5343  0.0000  1.9341
     12      0.5707        2.4401       0.5707        2.5282  0.0000  1.9421
     13      0.5732        2.4283       0.5732        2.5223  0.0000  1.9311
     14      0.5732        2.4216       0.5732        2.5165  0.0000  1.9321
     15      0.5732        2.4203       0.5732        2.5159  0.0000  1.9311
     16      0.5732        2.4167       0.5732        2.5153  0.0000  1.9301
     17      0.5732        2.4191       0.5732        2.5147  0.0000  1.9321
     18      0.5732        2.4203       0.5732        2.5141  0.0000  1.9301
     19      0.5732        2.4166       0.5732        2.5136  0.0000  1.9341
     20      0.5758        2.4155       0.5758        2.5130  0.0000  1.9331
     21      0.5758        2.4151       0.5758        2.5124  0.0000  1.9331
     22      0.5758        2.4181       0.5758        2.5123  0.0000  1.9321
     23      0.5758        2.4262       0.5758        2.5122  0.0000  1.9311
     24      0.5758        2.4128       0.5758        2.5122  0.0000  1.9331
     25      0.5758        2.4145       0.5758        2.5121  0.0000  1.9341
     26      0.5758        2.4139       0.5758        2.5121  0.0000  1.9321
     27      0.5758        2.4140       0.5758        2.5120  0.0000  1.9471
     28      0.5758        2.4156       0.5758        2.5119  0.0000  1.9361
     29      0.5758        2.4127       0.5758        2.5119  0.0000  1.9351
     30      0.5758        2.4127       0.5758        2.5119  0.0000  1.9401
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1490        2.9565       0.1490        2.9273  0.0000  1.9341
      2      0.2525        2.8635       0.2525        2.8555  0.0000  1.9361
      3      0.3131        2.7873       0.3131        2.7848  0.0000  1.9411
      4      0.3763        2.7054       0.3763        2.7188  0.0000  1.9431
      5      0.4242        2.6222       0.4242        2.6530  0.0000  1.9371
      6      0.4722        2.5468       0.4722        2.5906  0.0000  1.9341
      7      0.5000        2.4797       0.5000        2.5308  0.0000  1.9361
      8      0.5101        2.4398       0.5101        2.5250  0.0000  1.9331
      9      0.5101        2.4236       0.5101        2.5192  0.0000  1.9371
     10      0.5076        2.4172       0.5076        2.5134  0.0000  1.9351
     11      0.5076        2.4185       0.5076        2.5075  0.0000  1.9341
     12      0.5076        2.4112       0.5076        2.5018  0.0000  1.9401
     13      0.5152        2.3964       0.5152        2.4961  0.0000  1.9321
     14      0.5227        2.3927       0.5227        2.4903  0.0000  1.9331
     15      0.5227        2.3868       0.5227        2.4897  0.0000  1.9301
     16      0.5227        2.3862       0.5227        2.4892  0.0000  1.9321
     17      0.5227        2.3905       0.5227        2.4886  0.0000  1.9321
     18      0.5227        2.3876       0.5227        2.4880  0.0000  1.9321
     19      0.5227        2.3870       0.5227        2.4874  0.0000  1.9311
     20      0.5227        2.3843       0.5227        2.4869  0.0000  1.9311
     21      0.5253        2.3840       0.5253        2.4863  0.0000  1.9321
     22      0.5253        2.3864       0.5253        2.4862  0.0000  1.9311
     23      0.5253        2.3907       0.5253        2.4862  0.0000  1.9321
     24      0.5253        2.3875       0.5253        2.4861  0.0000  1.9321
     25      0.5253        2.3876       0.5253        2.4861  0.0000  1.9321
     26      0.5253        2.3828       0.5253        2.4860  0.0000  1.9311
     27      0.5253        2.3878       0.5253        2.4859  0.0000  1.9291
     28      0.5253        2.3894       0.5253        2.4859  0.0000  1.9321
     29      0.5253        2.3839       0.5253        2.4859  0.0000  1.9351
     30      0.5253        2.3930       0.5253        2.4859  0.0000  1.9351
Stopping since valid_loss has not improved in the last 5 epochs.
[INFO] Cross-validation scores with fixed parameters: [0.6141414141414141, 0.5555555555555556, 0.5890688259109311, 0.5728744939271255, 0.5809716599190283]
[INFO] Model and components saved to logodetection.pth and scaler.pkl
[INFO] Evaluating final model...


[INFO] Evaluation Metrics
[INFO] ==================
[INFO] Accuracy: 0.6023462783171522
[INFO] Precision: 0.6361323044129795
[INFO] Recall: 0.5345453615902386
[INFO] Specificity: 0.9658752569884929
[INFO] F1 Score: 0.5115129606701718
[INFO] Confusion Matrix:
[[ 40   9   4   0   3   0   9   6   0   8   2   1   0   1   0   0   0   5
    4   0]
 [  0 157   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
    0   0]
 [  2   0 108   0   3   1   6   0   0   0   4   0   0   1   0   0   0   0
    1   0]
 [  2   3  10   0  12   8   5   1   0   5   1   0   1   1   0   0   0   5
    6   0]
 [  1   5  20   0  62   3   3   0   0   5  11   0   0   0   0   0   0   6
    5   0]
 [  3  10   0   0   0 108   3   1   0   5   1   0   3   1   0   0   0   5
    9   0]
 [  1  12   6   0   0   0 140   2   0  12   0   0   0   0   0   0   0   6
    5   0]
 [  2   1   1   0   0   0   0 176   0   1   0   0   0   0   1   0   0   0
    0   0]
 [  1  12  12   0  10   3   8   0   1  12  10   1   1   4   3   0   0   5
    3   0]
 [  0  11   0   0   0   2   7   0   0 130   1   0   0   1   0   0   0   2
   14   0]
 [  3   8   9   0   5   0  13   3   0   9  91   0   0   1   0   0   0   2
    1   0]
 [  2   3   2   0   1   9   1   0   0   3   0  63   0   3   0   0   0  21
    8   0]
 [  2  17   1   0   6   7   7  16   1  16   1   2  31   2   1   0   0   8
    9   0]
 [  1   4   5   0   0   1   4   1   1   5   1   3   1 116   0   0   0   0
    7   0]
 [  2   8  24   0  17   6   8   1   0  15   3   0   0   1  22   0   0   8
   11   0]
 [  1   7   2   0   0   1   1   0   0   7   0   0   0   0   0  29   0   2
    0   0]
 [  6  18   6   0   6   4   6   3   0  12   0   1   0   2   1   0  23  11
    2   0]
 [  0   7   1   0   2   7  12   0   0  14   0   2   0   3   2   0   0  49
   12   0]
 [  0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0
  139   0]
 [ 10  17   9   0   6   0   4   0   0   7   3   0   0   5   2   0   0   6
    7   4]]

[INFO] Total time taken: 1653.3304316997528 seconds

Process finished with exit code 0
