C:\Users\cywong\AppData\Local\Programs\Python\Python310\python.exe C:/Users/cywong/PycharmProjects/logodetection/logodetection_training.py
[INFO] Starting training process...
[INFO] Preprocessing images...
[INFO] Finished preprocessing images.
[INFO] Loading images and extracting LBP features...
[INFO] Finished loading images and extracting LBP features.
[INFO] Balancing classes...
[WARNING] Skipping batch 16 due to only one class present.
[INFO] Finished balancing classes.
[INFO] Extracting ResNet-50 features...
[INFO] Finished extracting ResNet-50 features.
[INFO] Combining features...
[INFO] Finished combining and scaling features.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1313        2.9749       0.1313        2.9310  0.0000  2.0220
      2      0.2854        2.8853       0.2854        2.8561  0.0000  1.9331
      3      0.3611        2.8036       0.3611        2.7805  0.0000  1.9301
      4      0.4167        2.7211       0.4167        2.7109  0.0000  1.9301
      5      0.4520        2.6404       0.4520        2.6417  0.0000  1.9301
      6      0.5000        2.5674       0.5000        2.5757  0.0000  1.9311
      7      0.5354        2.4928       0.5354        2.5144  0.0000  1.9331
      8      0.5455        2.4472       0.5455        2.5082  0.0000  1.9321
      9      0.5455        2.4365       0.5455        2.5022  0.0000  1.9321
     10      0.5480        2.4289       0.5480        2.4960  0.0000  1.9291
     11      0.5530        2.4232       0.5530        2.4900  0.0000  1.9311
     12      0.5606        2.4130       0.5606        2.4840  0.0000  1.9301
     13      0.5657        2.4169       0.5657        2.4779  0.0000  1.9301
     14      0.5732        2.4080       0.5732        2.4720  0.0000  1.9311
     15      0.5732        2.3990       0.5732        2.4713  0.0000  1.9331
     16      0.5732        2.4002       0.5732        2.4707  0.0000  1.9331
     17      0.5732        2.3960       0.5732        2.4702  0.0000  1.9351
     18      0.5732        2.3982       0.5732        2.4695  0.0000  1.9341
     19      0.5732        2.3945       0.5732        2.4689  0.0000  1.9311
     20      0.5732        2.3952       0.5732        2.4683  0.0000  1.9321
     21      0.5758        2.3967       0.5758        2.4677  0.0000  1.9331
     22      0.5758        2.4008       0.5758        2.4677  0.0000  1.9321
     23      0.5758        2.4032       0.5758        2.4676  0.0000  1.9331
     24      0.5758        2.3951       0.5758        2.4675  0.0000  1.9341
     25      0.5758        2.3911       0.5758        2.4675  0.0000  1.9321
     26      0.5758        2.3928       0.5758        2.4674  0.0000  1.9311
     27      0.5758        2.3962       0.5758        2.4674  0.0000  1.9331
     28      0.5758        2.3998       0.5758        2.4673  0.0000  1.9341
     29      0.5758        2.3985       0.5758        2.4673  0.0000  1.9411
     30      0.5758        2.3961       0.5758        2.4673  0.0000  1.9461
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1515        2.9652       0.1515        2.9143  0.0000  1.9491
      2      0.2854        2.8707       0.2854        2.8371  0.0000  1.9391
      3      0.4091        2.7873       0.4091        2.7625  0.0000  1.9441
      4      0.4848        2.7074       0.4848        2.6916  0.0000  1.9401
      5      0.5480        2.6277       0.5480        2.6236  0.0000  1.9441
      6      0.5808        2.5550       0.5808        2.5578  0.0000  1.9451
      7      0.6086        2.4822       0.6086        2.4956  0.0000  1.9381
      8      0.6136        2.4331       0.6136        2.4896  0.0000  1.9361
      9      0.6162        2.4270       0.6162        2.4836  0.0000  1.9381
     10      0.6162        2.4275       0.6162        2.4776  0.0000  1.9371
     11      0.6162        2.4179       0.6162        2.4715  0.0000  1.9371
     12      0.6187        2.4131       0.6187        2.4656  0.0000  1.9541
     13      0.6187        2.4089       0.6187        2.4596  0.0000  1.9311
     14      0.6212        2.4002       0.6212        2.4537  0.0000  1.9341
     15      0.6212        2.3906       0.6212        2.4531  0.0000  1.9311
     16      0.6212        2.3835       0.6212        2.4525  0.0000  1.9381
     17      0.6212        2.3899       0.6212        2.4519  0.0000  1.9331
     18      0.6212        2.3902       0.6212        2.4513  0.0000  1.9331
     19      0.6212        2.3832       0.6212        2.4507  0.0000  1.9321
     20      0.6212        2.3808       0.6212        2.4501  0.0000  1.9341
     21      0.6212        2.3866       0.6212        2.4495  0.0000  1.9341
     22      0.6212        2.3850       0.6212        2.4494  0.0000  1.9321
     23      0.6212        2.3835       0.6212        2.4494  0.0000  1.9321
     24      0.6212        2.3815       0.6212        2.4493  0.0000  1.9331
     25      0.6212        2.3823       0.6212        2.4493  0.0000  1.9361
     26      0.6212        2.3828       0.6212        2.4492  0.0000  1.9341
     27      0.6212        2.3846       0.6212        2.4491  0.0000  1.9311
     28      0.6212        2.3841       0.6212        2.4491  0.0000  1.9301
     29      0.6212        2.3884       0.6212        2.4491  0.0000  1.9341
     30      0.6212        2.3872       0.6212        2.4491  0.0000  1.9311
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1212        2.9885       0.1212        2.9262  0.0000  1.9291
      2      0.2702        2.8964       0.2702        2.8514  0.0000  1.9291
      3      0.3636        2.8094       0.3636        2.7807  0.0000  1.9301
      4      0.4646        2.7246       0.4646        2.7104  0.0000  1.9301
      5      0.5253        2.6493       0.5253        2.6426  0.0000  1.9291
      6      0.5530        2.5746       0.5530        2.5776  0.0000  1.9291
      7      0.5884        2.4984       0.5884        2.5142  0.0000  1.9291
      8      0.5909        2.4574       0.5909        2.5080  0.0000  1.9281
      9      0.5960        2.4440       0.5960        2.5019  0.0000  1.9291
     10      0.5985        2.4454       0.5985        2.4958  0.0000  1.9301
     11      0.6035        2.4327       0.6035        2.4897  0.0000  1.9321
     12      0.6035        2.4351       0.6035        2.4837  0.0000  1.9311
     13      0.6035        2.4231       0.6035        2.4776  0.0000  1.9331
     14      0.6111        2.4218       0.6111        2.4715  0.0000  1.9311
     15      0.6111        2.4127       0.6111        2.4709  0.0000  1.9361
     16      0.6111        2.4068       0.6111        2.4703  0.0000  1.9361
     17      0.6111        2.4064       0.6111        2.4697  0.0000  1.9341
     18      0.6111        2.4072       0.6111        2.4690  0.0000  1.9351
     19      0.6111        2.4055       0.6111        2.4684  0.0000  1.9361
     20      0.6111        2.4059       0.6111        2.4678  0.0000  1.9331
     21      0.6111        2.4043       0.6111        2.4672  0.0000  1.9331
     22      0.6111        2.4018       0.6111        2.4672  0.0000  1.9371
     23      0.6111        2.3983       0.6111        2.4671  0.0000  1.9351
     24      0.6111        2.4010       0.6111        2.4670  0.0000  1.9341
     25      0.6111        2.4004       0.6111        2.4670  0.0000  1.9381
     26      0.6111        2.4013       0.6111        2.4669  0.0000  1.9411
     27      0.6111        2.4095       0.6111        2.4669  0.0000  1.9401
     28      0.6111        2.3993       0.6111        2.4668  0.0000  1.9321
     29      0.6111        2.4075       0.6111        2.4668  0.0000  1.9341
     30      0.6111        2.4054       0.6111        2.4668  0.0000  1.9341
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1439        2.9866       0.1439        2.9274  0.0000  1.9351
      2      0.2828        2.8840       0.2828        2.8556  0.0000  1.9371
      3      0.3864        2.8079       0.3864        2.7860  0.0000  1.9351
      4      0.4470        2.7248       0.4470        2.7173  0.0000  1.9351
      5      0.4848        2.6344       0.4848        2.6512  0.0000  1.9331
      6      0.5177        2.5630       0.5177        2.5885  0.0000  1.9381
      7      0.5606        2.4903       0.5606        2.5267  0.0000  1.9351
      8      0.5631        2.4492       0.5631        2.5208  0.0000  1.9351
      9      0.5707        2.4354       0.5707        2.5148  0.0000  1.9381
     10      0.5707        2.4318       0.5707        2.5089  0.0000  1.9351
     11      0.5758        2.4221       0.5758        2.5029  0.0000  1.9361
     12      0.5783        2.4101       0.5783        2.4970  0.0000  1.9451
     13      0.5909        2.4106       0.5909        2.4911  0.0000  1.9331
     14      0.5960        2.3988       0.5960        2.4852  0.0000  1.9361
     15      0.5960        2.4042       0.5960        2.4846  0.0000  1.9321
     16      0.5960        2.3985       0.5960        2.4841  0.0000  1.9351
     17      0.5960        2.3929       0.5960        2.4835  0.0000  1.9341
     18      0.5960        2.3951       0.5960        2.4829  0.0000  1.9321
     19      0.5960        2.3948       0.5960        2.4823  0.0000  1.9321
     20      0.5960        2.3919       0.5960        2.4817  0.0000  1.9331
     21      0.5960        2.3974       0.5960        2.4811  0.0000  1.9331
     22      0.5960        2.3982       0.5960        2.4810  0.0000  1.9271
     23      0.5960        2.3959       0.5960        2.4810  0.0000  1.9281
     24      0.5960        2.3938       0.5960        2.4809  0.0000  1.9281
     25      0.5960        2.3957       0.5960        2.4809  0.0000  1.9281
     26      0.5960        2.3988       0.5960        2.4808  0.0000  1.9261
     27      0.5960        2.3931       0.5960        2.4807  0.0000  1.9311
     28      0.5960        2.4016       0.5960        2.4807  0.0000  1.9301
     29      0.5960        2.3987       0.5960        2.4807  0.0000  1.9321
     30      0.5960        2.3915       0.5960        2.4807  0.0000  1.9281
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1086        2.9894       0.1086        2.9302  0.0000  1.9251
      2      0.2374        2.8969       0.2374        2.8547  0.0000  1.9291
      3      0.3384        2.8153       0.3384        2.7838  0.0000  1.9291
      4      0.4116        2.7318       0.4116        2.7136  0.0000  1.9291
      5      0.4646        2.6489       0.4646        2.6467  0.0000  1.9271
      6      0.5051        2.5786       0.5051        2.5827  0.0000  1.9331
      7      0.5328        2.5014       0.5328        2.5208  0.0000  1.9301
      8      0.5404        2.4580       0.5404        2.5148  0.0000  1.9331
      9      0.5404        2.4501       0.5404        2.5088  0.0000  1.9321
     10      0.5429        2.4477       0.5429        2.5029  0.0000  1.9291
     11      0.5455        2.4444       0.5455        2.4970  0.0000  1.9321
     12      0.5455        2.4201       0.5455        2.4911  0.0000  1.9311
     13      0.5455        2.4207       0.5455        2.4851  0.0000  1.9311
     14      0.5455        2.4125       0.5455        2.4792  0.0000  1.9321
     15      0.5455        2.4162       0.5455        2.4786  0.0000  1.9301
     16      0.5455        2.4114       0.5455        2.4780  0.0000  1.9301
     17      0.5455        2.4098       0.5455        2.4775  0.0000  1.9331
     18      0.5455        2.4146       0.5455        2.4769  0.0000  1.9301
     19      0.5455        2.4163       0.5455        2.4763  0.0000  1.9311
     20      0.5455        2.4021       0.5455        2.4757  0.0000  1.9311
     21      0.5455        2.4132       0.5455        2.4751  0.0000  1.9401
     22      0.5455        2.4112       0.5455        2.4750  0.0000  1.9381
     23      0.5455        2.4084       0.5455        2.4750  0.0000  1.9311
     24      0.5455        2.4083       0.5455        2.4749  0.0000  1.9311
     25      0.5455        2.4053       0.5455        2.4748  0.0000  1.9341
     26      0.5455        2.4022       0.5455        2.4748  0.0000  1.9311
     27      0.5455        2.4122       0.5455        2.4747  0.0000  1.9301
     28      0.5455        2.4036       0.5455        2.4747  0.0000  1.9301
     29      0.5455        2.4063       0.5455        2.4747  0.0000  1.9331
     30      0.5455        2.4061       0.5455        2.4747  0.0000  1.9341
Stopping since valid_loss has not improved in the last 5 epochs.
[INFO] Cross-validation scores with fixed parameters: [0.5353535353535354, 0.5676767676767677, 0.597165991902834, 0.6052631578947368, 0.5890688259109311]
[INFO] Model and components saved to logodetection.pth and scaler.pkl
[INFO] Evaluating final model...


[INFO] Evaluation Metrics
[INFO] ==================
[INFO] Accuracy: 0.6181229773462783
[INFO] Precision: 0.6883051379154906
[INFO] Recall: 0.5617068726909646
[INFO] Specificity: 0.9686054605090495
[INFO] F1 Score: 0.5384960941902732
[INFO] Confusion Matrix:
[[ 25   7  14   0   7   4   4   3   0   2  10   3   0   0   8   3   0   1
    1   0]
 [  0 155   0   0   0   0   0   0   0   0   2   1   0   0   0   0   0   0
    0   0]
 [  0   0 116   0   7   1   0   0   0   0   1   0   0   0   1   0   0   0
    0   0]
 [  0   0  18   2   5  11   5   0   0   0   3  12   1   0   1   0   0   0
    2   0]
 [  0   0  14   0  72  14   5   2   0   0   6   7   0   0   1   0   0   0
    0   0]
 [  0   0   2   0   1 133   0   0   0   0   0   8   0   4   0   0   0   0
    1   0]
 [  0   4  23   0   1   8 132   4   0   1   2   9   0   0   0   0   0   0
    0   0]
 [  0   0   1   0   0   0   0 173   0   0   1   6   0   0   1   0   0   0
    0   0]
 [  0   5  19   0  20   6   6   2   0   0  12   6   0   2   6   0   2   0
    0   0]
 [  0   8   6   0   8  15   5   9   2  92   3   6   0   2   0   0   0   4
    8   0]
 [  0   1   6   0  13   3   4   3   0   1 111   2   0   0   0   0   0   0
    0   1]
 [  0   3   5   0   0   6   1   1   0   0   1  94   0   1   4   0   0   0
    0   0]
 [  0  12   8   0   3  15   4   7   0   0   3  22  40   3   3   0   0   5
    2   0]
 [  0   5   6   0   2  13   0   4   0   0   3  10   0 105   1   0   0   0
    1   0]
 [  1   1  27   0  20  10   4   2   0   3   6   7   0   0  44   0   1   0
    0   0]
 [  0   1   1   0   0   1   1   1   0   0   2   0   0   0   0  42   0   1
    0   0]
 [  2   3   5   0   9   7   4   7   0   1   2  25   0   0   0   1  35   0
    0   0]
 [  0   6  19   0   4  12  15   0   0   0   8  23   1   0   4   0   2  15
    2   0]
 [  0   0   2   0   0   1   0   0   0   0   2   2   0   0   0   0   0   0
  133   0]
 [  0   6  13   0   8  12   3   3   0   1  11  10   0   0   2   0   1   0
    1   9]]

[INFO] Total time taken: 1654.7668516635895 seconds

Process finished with exit code 0
