C:\Users\cywong\AppData\Local\Programs\Python\Python310\python.exe C:/Users/cywong/PycharmProjects/logodetection/logodetection_training.py
[INFO] Starting training process...
[INFO] Preprocessing images...
[INFO] Finished preprocessing images.
[INFO] Loading images and extracting LBP features...
[INFO] Finished loading images and extracting LBP features.
[INFO] Balancing classes...
[WARNING] Skipping batch 16 due to only one class present.
[INFO] Finished balancing classes.
[INFO] Extracting ResNet-50 features...
[INFO] Finished extracting ResNet-50 features.
[INFO] Combining features...
[INFO] Finished combining and scaling features.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1793        2.9766       0.1793        2.9151  0.0000  1.7341
      2      0.2449        2.8902       0.2449        2.8407  0.0000  1.6841
      3      0.3485        2.7988       0.3485        2.7705  0.0000  1.7109
      4      0.4343        2.7197       0.4343        2.7006  0.0000  1.6547
      5      0.5051        2.6471       0.5051        2.6347  0.0000  1.6615
      6      0.5530        2.5590       0.5530        2.5722  0.0000  1.6624
      7      0.5758        2.5058       0.5758        2.5113  0.0000  1.6406
      8      0.5758        2.4558       0.5758        2.5054  0.0000  1.6414
      9      0.5783        2.4405       0.5783        2.4995  0.0000  1.6190
     10      0.5783        2.4383       0.5783        2.4936  0.0000  1.6497
     11      0.5859        2.4330       0.5859        2.4878  0.0000  1.6253
     12      0.5884        2.4221       0.5884        2.4820  0.0000  1.6115
     13      0.5985        2.4183       0.5985        2.4761  0.0000  1.6037
     14      0.5985        2.4091       0.5985        2.4702  0.0000  1.5985
     15      0.5985        2.4059       0.5985        2.4696  0.0000  1.6422
     16      0.5985        2.4014       0.5985        2.4691  0.0000  1.6347
     17      0.5985        2.4048       0.5985        2.4685  0.0000  1.6104
     18      0.5985        2.4054       0.5985        2.4679  0.0000  1.6128
     19      0.5985        2.4037       0.5985        2.4673  0.0000  1.6210
     20      0.5985        2.4056       0.5985        2.4667  0.0000  1.6417
     21      0.5960        2.4013       0.5960        2.4662  0.0000  1.6426
     22      0.5960        2.4044       0.5960        2.4661  0.0000  1.6194
     23      0.5960        2.4050       0.5960        2.4660  0.0000  1.5819
     24      0.5960        2.4025       0.5960        2.4660  0.0000  1.6206
     25      0.5960        2.4053       0.5960        2.4659  0.0000  1.6262
     26      0.5960        2.4029       0.5960        2.4659  0.0000  1.6156
     27      0.5960        2.3976       0.5960        2.4658  0.0000  1.6407
     28      0.5960        2.4009       0.5960        2.4657  0.0000  1.6366
     29      0.5960        2.4045       0.5960        2.4657  0.0000  1.6278
     30      0.5960        2.4045       0.5960        2.4657  0.0000  1.7108
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1313        3.0013       0.1313        2.9319  0.0000  1.9566
      2      0.2702        2.9029       0.2702        2.8599  0.0000  1.8364
      3      0.3460        2.8202       0.3460        2.7890  0.0000  1.9056
      4      0.4192        2.7495       0.4192        2.7189  0.0000  1.7164
      5      0.4949        2.6611       0.4949        2.6523  0.0000  1.6861
      6      0.5177        2.5844       0.5177        2.5891  0.0000  1.6542
      7      0.5455        2.5133       0.5455        2.5272  0.0000  1.6622
      8      0.5455        2.4701       0.5455        2.5212  0.0000  1.7859
      9      0.5455        2.4730       0.5455        2.5152  0.0000  2.4674
     10      0.5480        2.4627       0.5480        2.5093  0.0000  2.4731
     11      0.5480        2.4513       0.5480        2.5033  0.0000  2.2744
     12      0.5556        2.4471       0.5556        2.4974  0.0000  2.1061
     13      0.5556        2.4342       0.5556        2.4915  0.0000  1.7744
     14      0.5530        2.4319       0.5530        2.4855  0.0000  2.4412
     15      0.5530        2.4324       0.5530        2.4849  0.0000  2.5885
     16      0.5530        2.4259       0.5530        2.4844  0.0000  2.4989
     17      0.5530        2.4222       0.5530        2.4838  0.0000  2.4909
     18      0.5556        2.4222       0.5556        2.4832  0.0000  2.5241
     19      0.5556        2.4249       0.5556        2.4826  0.0000  2.3751
     20      0.5556        2.4201       0.5556        2.4820  0.0000  1.9159
     21      0.5556        2.4228       0.5556        2.4814  0.0000  1.8129
     22      0.5556        2.4222       0.5556        2.4813  0.0000  1.7943
     23      0.5556        2.4202       0.5556        2.4813  0.0000  1.8134
     24      0.5556        2.4234       0.5556        2.4812  0.0000  1.7029
     25      0.5556        2.4257       0.5556        2.4811  0.0000  1.7071
     26      0.5556        2.4244       0.5556        2.4811  0.0000  1.7111
     27      0.5556        2.4206       0.5556        2.4810  0.0000  1.7924
     28      0.5581        2.4235       0.5581        2.4810  0.0000  1.9590
     29      0.5581        2.4251       0.5581        2.4810  0.0000  1.7051
     30      0.5581        2.4161       0.5581        2.4809  0.0000  1.7383
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1818        2.9766       0.1818        2.9150  0.0000  1.9830
      2      0.2778        2.8777       0.2778        2.8424  0.0000  1.9686
      3      0.3636        2.8053       0.3636        2.7729  0.0000  2.0148
      4      0.4293        2.7265       0.4293        2.7062  0.0000  1.9825
      5      0.5076        2.6355       0.5076        2.6403  0.0000  1.9628
      6      0.5530        2.5629       0.5530        2.5765  0.0000  1.9864
      7      0.5808        2.4889       0.5808        2.5149  0.0000  1.9613
      8      0.5808        2.4431       0.5808        2.5089  0.0000  1.9484
      9      0.5808        2.4456       0.5808        2.5030  0.0000  1.9718
     10      0.5808        2.4343       0.5808        2.4970  0.0000  1.9539
     11      0.5859        2.4254       0.5859        2.4910  0.0000  1.9279
     12      0.5884        2.4262       0.5884        2.4850  0.0000  1.6075
     13      0.5884        2.4149       0.5884        2.4790  0.0000  1.6167
     14      0.5909        2.4098       0.5909        2.4731  0.0000  1.5804
     15      0.5909        2.4010       0.5909        2.4725  0.0000  1.6354
     16      0.5909        2.4068       0.5909        2.4719  0.0000  1.7518
     17      0.5909        2.3973       0.5909        2.4713  0.0000  1.9563
     18      0.5909        2.3987       0.5909        2.4707  0.0000  1.9541
     19      0.5909        2.4010       0.5909        2.4702  0.0000  1.9526
     20      0.5909        2.3881       0.5909        2.4696  0.0000  1.9738
     21      0.5909        2.3954       0.5909        2.4690  0.0000  1.9753
     22      0.5909        2.4008       0.5909        2.4689  0.0000  1.9632
     23      0.5909        2.4016       0.5909        2.4688  0.0000  1.9611
     24      0.5909        2.4001       0.5909        2.4688  0.0000  1.9555
     25      0.5909        2.3960       0.5909        2.4687  0.0000  1.9644
     26      0.5909        2.4001       0.5909        2.4687  0.0000  1.9596
     27      0.5909        2.3995       0.5909        2.4686  0.0000  1.9624
     28      0.5909        2.3986       0.5909        2.4685  0.0000  1.9603
     29      0.5909        2.3975       0.5909        2.4685  0.0000  2.0262
     30      0.5909        2.4005       0.5909        2.4685  0.0000  1.9575
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1768        2.9752       0.1768        2.9215  0.0000  1.9558
      2      0.2904        2.8860       0.2904        2.8500  0.0000  1.9529
      3      0.3460        2.8043       0.3460        2.7803  0.0000  1.9551
      4      0.3939        2.7237       0.3939        2.7129  0.0000  1.9504
      5      0.4343        2.6482       0.4343        2.6476  0.0000  1.9649
      6      0.4596        2.5698       0.4596        2.5850  0.0000  1.9538
      7      0.4798        2.4910       0.4798        2.5247  0.0000  1.9529
      8      0.4798        2.4545       0.4798        2.5188  0.0000  1.9654
      9      0.4823        2.4512       0.4823        2.5129  0.0000  1.9591
     10      0.4874        2.4377       0.4874        2.5070  0.0000  1.9497
     11      0.4899        2.4285       0.4899        2.5013  0.0000  1.9498
     12      0.4899        2.4253       0.4899        2.4955  0.0000  1.9604
     13      0.5000        2.4197       0.5000        2.4897  0.0000  1.9660
     14      0.5000        2.4024       0.5000        2.4839  0.0000  1.9645
     15      0.5000        2.4120       0.5000        2.4833  0.0000  1.9682
     16      0.5000        2.4102       0.5000        2.4827  0.0000  1.9631
     17      0.5000        2.4047       0.5000        2.4822  0.0000  1.9622
     18      0.5000        2.4039       0.5000        2.4816  0.0000  1.9658
     19      0.5000        2.3991       0.5000        2.4810  0.0000  1.9427
     20      0.5000        2.4014       0.5000        2.4804  0.0000  1.9492
     21      0.5000        2.4020       0.5000        2.4798  0.0000  1.9556
     22      0.5000        2.4089       0.5000        2.4798  0.0000  1.9731
     23      0.5000        2.4018       0.5000        2.4797  0.0000  1.9748
     24      0.5000        2.4008       0.5000        2.4797  0.0000  1.9602
     25      0.5000        2.3941       0.5000        2.4796  0.0000  1.9515
     26      0.5000        2.4014       0.5000        2.4795  0.0000  2.0248
     27      0.5000        2.4052       0.5000        2.4795  0.0000  2.0072
     28      0.5000        2.4048       0.5000        2.4794  0.0000  1.9643
     29      0.5000        2.4075       0.5000        2.4794  0.0000  1.9615
     30      0.5000        2.3992       0.5000        2.4794  0.0000  1.9638
Stopping since valid_loss has not improved in the last 5 epochs.
Re-initializing module because the following parameters were re-set: input_dim, output_dim.
Re-initializing criterion.
Re-initializing optimizer.
  epoch    accuracy    train_loss    valid_acc    valid_loss      lr     dur
-------  ----------  ------------  -----------  ------------  ------  ------
      1      0.1061        2.9837       0.1061        2.9273  0.0000  2.0315
      2      0.2753        2.8938       0.2753        2.8552  0.0000  1.9540
      3      0.3510        2.8099       0.3510        2.7855  0.0000  1.9553
      4      0.4192        2.7357       0.4192        2.7180  0.0000  1.9605
      5      0.4798        2.6474       0.4798        2.6530  0.0000  1.9506
      6      0.5051        2.5805       0.5051        2.5891  0.0000  1.9493
      7      0.5379        2.4998       0.5379        2.5298  0.0000  1.9744
      8      0.5379        2.4579       0.5379        2.5238  0.0000  1.9555
      9      0.5379        2.4414       0.5379        2.5179  0.0000  1.9583
     10      0.5404        2.4425       0.5404        2.5120  0.0000  1.9855
     11      0.5429        2.4372       0.5429        2.5062  0.0000  1.9843
     12      0.5429        2.4267       0.5429        2.5004  0.0000  1.9643
     13      0.5480        2.4246       0.5480        2.4945  0.0000  1.9592
     14      0.5480        2.4207       0.5480        2.4887  0.0000  1.9488
     15      0.5505        2.4151       0.5505        2.4881  0.0000  1.9569
     16      0.5505        2.4170       0.5505        2.4875  0.0000  1.9453
     17      0.5505        2.4063       0.5505        2.4869  0.0000  1.9449
     18      0.5530        2.4097       0.5530        2.4863  0.0000  1.9496
     19      0.5530        2.4044       0.5530        2.4857  0.0000  1.9443
     20      0.5530        2.4101       0.5530        2.4852  0.0000  1.9424
     21      0.5530        2.4079       0.5530        2.4846  0.0000  1.9417
     22      0.5530        2.4072       0.5530        2.4845  0.0000  1.9567
     23      0.5530        2.4077       0.5530        2.4845  0.0000  1.9593
     24      0.5530        2.4069       0.5530        2.4844  0.0000  2.0049
     25      0.5530        2.4151       0.5530        2.4843  0.0000  1.9626
     26      0.5530        2.4057       0.5530        2.4843  0.0000  1.9574
     27      0.5530        2.4033       0.5530        2.4842  0.0000  1.9625
     28      0.5530        2.4047       0.5530        2.4842  0.0000  2.0125
     29      0.5530        2.4068       0.5530        2.4842  0.0000  1.9406
     30      0.5530        2.4083       0.5530        2.4842  0.0000  1.9523
Stopping since valid_loss has not improved in the last 5 epochs.
[INFO] Cross-validation scores with fixed parameters: [0.591919191919192, 0.5616161616161616, 0.5728744939271255, 0.5323886639676113, 0.5728744939271255]
[INFO] Model and components saved to logodetection.pth and scaler.pkl
[INFO] Evaluating final model...


[INFO] Evaluation Metrics
[INFO] ==================
[INFO] Accuracy: 0.6197411003236246
[INFO] Precision: 0.6324781525309723
[INFO] Recall: 0.5583043626530413
[INFO] Specificity: 0.9687292197327819
[INFO] F1 Score: 0.540166789276548
[INFO] Confusion Matrix:
[[ 35   4   4   0   1   9   1   7   4   1   4   0   0   5   1   0   9   0
    7   0]
 [  2 156   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
    0   0]
 [  0   0 106   0   0   3   1   0   0   0   4   0   0   5   1   0   2   0
    4   0]
 [  1   0  11   0   0  21   1   1   2   3   1   0   1   1   7   0   1   1
    8   0]
 [  4   0  19   0  41  22   1   0   2   5   8   0   0   2   6   0   8   0
    3   0]
 [  0   2   0   0   0 129   0   1   1   0   1   0   4   0   6   0   2   0
    3   0]
 [  0   4   9   0   0  10 135   1   2   3   4   2   0   3   1   0   1   2
    7   0]
 [  0   0   1   0   0   1   0 177   0   0   1   0   0   0   0   0   1   0
    1   0]
 [  0   2  12   0   2  22   3   3   6   2  14   0   3   3   4   0   3   0
    6   1]
 [  0   0   4   0   0  10   2   2   0 121   7   0   0   4   2   0   6   0
   10   0]
 [  0   2   8   0   2   7   3   1   6   4 100   0   0   0   0   0  12   0
    0   0]
 [  0   2   3   0   0  10   0   0   4   0   1  73   0   0   0   0  14   1
    8   0]
 [  0   6   2   0   0  26   2  15   0   1   0   0  38   6   4   0  20   0
    7   0]
 [  0   3   3   0   1  10   0   4   1   0   0   4   0 116   2   0   1   0
    5   0]
 [  1   1  26   0   3  33   1   2   4   1   3   2   5   2  27   0   7   1
    7   0]
 [  3   0   0   0   0   0   0   1   0   1   4   0   0   0   2  34   5   0
    0   0]
 [  0   2   3   0   0  10   0   3   1   0   0   4   1   3   0   0  72   0
    2   0]
 [  0   5   4   0   0  25   4   2   3   4   6   1   0   3   3   0  17  27
    7   0]
 [  0   0   0   0   0   1   0   0   1   0   0   0   0   1   0   0   1   1
  135   0]
 [  2   3  11   0   0   5   1   2   2   5  14   2   0   3   0   1  14   0
   11   4]]

[INFO] Total time taken: 1620.4253571033478 seconds

Process finished with exit code 0
